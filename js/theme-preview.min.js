(function(a){a.fn.gridOverlay=function(e){var e=a.extend({columns:12,columnWidth:60,color:"#ccc",opacity:40},e),b=a('<div style="display:none;overflow:hidden;position:absolute;left:0;top:0;width:100%;height:'+(this.height()-40)+'px;z-index: 999;">'),c=a('<div style="position:relative;width:960px;height:100%;margin:0 auto;overflow:hidden;">');a('<a style="position:fixed;top:140px;left:20px;cursor:pointer;padding:5px;background:red;color:#fff;font-weight:bold;z-index:9999;">GRID</a>').appendTo("#page").click(function(){b.toggle()});
for(var d=0;d<e.columns;d++)c.append('<div style="width:'+(0!=d?20:10)+'px;float:left;height:100%;"></div>'),c.append('<div style="width:'+e.columnWidth+"px;height:100%;float:left;background:"+e.color+";opacity:"+e.opacity/100+';"></div>');return this.each(function(){a(this).prepend(b.prepend(c))})}})(jQuery);
(function(a,e,b){e.fn.pm=function(){throw"usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])";};e.pm=a.pm=function(d){c.send(d)};e.pm.bind=a.pm.bind=function(d,a,b){c.bind(d,a,b)};e.pm.unbind=a.pm.unbind=function(d,a){c.unbind(d,a)};e.pm.origin=a.pm.origin=null;e.pm.poll=a.pm.poll=200;var c={send:function(d){var d=e.extend({},c.defaults,d),a=d.target;if(!d.target)throw"postmessage target window required";if(!d.type)throw"postmessage type required";var b={data:d.data,type:d.type};
d.success&&(b.callback=c._callback(d.success));d.error&&(b.errback=c._callback(d.error));"postMessage"in a&&(c._bind(),a.postMessage(JSON.stringify(b),d.origin||"*"))},bind:function(d,b,k){"postMessage"in a&&c._bind();var f=c.data("listeners.postmessage");f||(f={},c.data("listeners.postmessage",f));var g=f[d];g||(g=[],f[d]=g);g.push({fn:b,origin:k||e.pm.origin})},unbind:function(d,a){var b=c.data("listeners.postmessage");if(b)if(d)if(a){var e=b[d];if(e){for(var g=[],h=0,i=e.length;h<i;h++){var j=
e[h];j.fn!==a&&g.push(j)}b[d]=g}}else delete b[d];else for(h in b)delete b[h]},data:function(d,a){return a===b?c._data[d]:c._data[d]=a},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var a=[],b=0;32>b;b++)a[b]=c._CHARS[0|32*Math.random()];return a.join("")},_callback:function(a){var b=c.data("callbacks.postmessage");b||(b={},c.data("callbacks.postmessage",b));var e=c._random();b[e]=a;return e},_bind:function(){c.data("listening.postmessage")||
(a.addEventListener?a.addEventListener("message",c._dispatch,!1):a.attachEvent&&a.attachEvent("onmessage",c._dispatch),c.data("listening.postmessage",1))},_dispatch:function(a){try{var b=e.parseJSON(a.data)}catch(k){throw"postmessage data invalid json: "+k;}if(!b.type)throw"postmessage message type required";var f=(c.data("callbacks.postmessage")||{})[b.type];if(f)f(b.data);else for(var f=(c.data("listeners.postmessage")||{})[b.type]||[],g=0,h=f.length;g<h;g++){var i=f[g];if(i.origin&&a.origin!==
i.origin)throw b.errback&&c.send({target:a.source,data:{message:"postmessage origin mismatch",origin:[a.origin,i.origin]},type:b.errback}),"postmessage message origin mismatch - "+a.origin+" "+i.origin;try{var j=i.fn(b.data);b.callback&&c.send({target:a.source,data:j,type:b.callback})}catch(l){b.errback&&c.send({target:a.source,data:l,type:b.errback})}}}};e.extend(c,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*"}})})(this,jQuery);
jQuery(document).ready(function(a){atom_config.preview_mode&&(a("#page").gridOverlay(),pm.bind("background_color",function(e){e.color?(a(e.selector).css("background-color","#"+e.color),a("body").addClass("cbgc")):(a(e.selector).css("background-color",""),a("body").removeClass("cbgc"))}),pm.bind("logo",function(e){a("#logo a img").remove();a("#logo a").html("remove"!=e.url?'<img src="'+e.url+'" />':e.title)}),pm.bind("background_image",function(e){"remove"!=e.url?(a(e.selector).css("background-image",
'url("'+e.url+'")'),a("body").addClass("cbgi")):(a(e.selector).css("background-image",""),a("body").removeClass("cbgi"))}),pm.bind("color-scheme",function(e){var b=a("link#"+atom_config.id+"-core-css"),c=a("link#"+atom_config.id+"-style-css");a(b,c).attr("disabled","disabled");""!=e&&(b.replaceWith('<link rel="stylesheet" id="'+atom_config.id+'-core-css" href="'+atom_config.theme_url+'/css/core.css" type="text/css" />'),c.replaceWith('<link rel="stylesheet" id="'+atom_config.id+'-style-css" href="'+
atom_config.theme_url+"/css/style-"+e+'.css" type="text/css" />'))}),pm.bind("layout",function(e){a("body").removeClass("c1 c2 c2left c2right c3 c3left c3right").addClass(e)}),pm.bind("page_width",function(e){a("body").removeClass("fluid fixed").addClass(e)}),pm.bind("page_width_max",function(e){e=parseInt(e);400<e&&a(".page-content").css("max-width",e+"px")}),pm.bind("dimensions",function(e){var b=e.sizes.split(";");b[0]=parseInt(b[0]);b[1]=parseInt(b[1]);var c=e.unit,d=e.gs;switch(e.layout){case "c1":a("#primary-content").css({width:d+
c,left:"0"});a("#mask-1").css({right:0});a("#mask-2").css({right:0});break;case "c2left":a("#primary-content").css({width:d-b[0]+c,left:d+c});a("#sidebar").css({width:b[0]+c,left:"0"});a("#mask-1").css({right:d-b[0]+c});a("#mask-2").css({right:0});break;case "c2right":a("#primary-content").css({width:d-(d-b[0])+c,left:d-b[0]+c});a("#sidebar").css({width:d-b[0]+c,left:d-b[0]+c});a("#mask-1").css({right:d-b[0]+c});a("#mask-2").css({right:0});break;case "c3":a("#primary-content").css({width:d-b[0]-(d-
b[1])+c,left:d+c});a("#sidebar").css({width:b[0]+c,left:d-b[1]+c});a("#sidebar2").css({width:d-b[1]+c,left:d-b[0]+c});a("#mask-2").css({right:d-b[1]+c});a("#mask-1").css({right:d-b[0]-(d-b[1])+c});break;case "c3left":a("#primary-content").css({width:d-b[1]+c,left:d+(b[1]-b[0])+c});a("#sidebar").css({width:b[0]+c,left:b[1]-b[0]+c});a("#sidebar2").css({width:b[1]-b[0]+c,left:b[1]-b[0]+c});a("#mask-2").css({right:d-b[1]+c});a("#mask-1").css({right:b[1]-b[0]+c});break;case "c3right":a("#primary-content").css({width:b[0]+
c,left:d-b[0]-(d-b[1])+(d-b[1])+c}),a("#sidebar").css({width:d-b[0]-(d-b[1])+c,left:d-b[0]+c}),a("#sidebar2").css({width:d-b[1]+c,left:d-b[0]+c}),a("#mask-2").css({right:d-b[1]+c}),a("#mask-1").css({right:b[1]-b[0]+c})}}),a("body a").each(function(){var e=a(this).attr("href");e&&0!==e.indexOf("#")&&a(this).attr("href","#")}),pm({target:parent,type:"themepreview-load",data:!0}),a(document).trigger("theme_preview"))});